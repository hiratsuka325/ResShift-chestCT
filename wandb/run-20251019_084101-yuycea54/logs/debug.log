2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_setup.py:_flush():70] Current SDK version is 0.19.11
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_setup.py:_flush():70] Configure stats pid to 97336
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_setup.py:_flush():70] Loading settings from /root/.config/wandb/settings
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_setup.py:_flush():70] Loading settings from /workspace/lung/hiratsuka/ResShift/wandb/settings
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_setup.py:_flush():70] Loading settings from environment variables
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /workspace/lung/hiratsuka/ResShift/wandb/run-20251019_084101-yuycea54/logs/debug.log
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /workspace/lung/hiratsuka/ResShift/wandb/run-20251019_084101-yuycea54/logs/debug-internal.log
2025-10-19 08:41:02,106 INFO    MainThread:97336 [wandb_init.py:init():852] calling init triggers
2025-10-19 08:41:02,107 INFO    MainThread:97336 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'trainer': {'target': 'trainer.TrainerDifIR'}, 'model': {'target': 'models.unet.UNetModelSwin', 'ckpt_path': None, 'params': {'image_size': 64, 'in_channels': 3, 'model_channels': 160, 'out_channels': 3, 'attention_resolutions': [64, 32, 16, 8], 'dropout': 0, 'channel_mult': [1, 2, 2, 4], 'num_res_blocks': [2, 2, 2, 2], 'conv_resample': True, 'dims': 2, 'use_fp16': False, 'num_head_channels': 32, 'use_scale_shift_norm': True, 'resblock_updown': False, 'swin_depth': 2, 'swin_embed_dim': 192, 'window_size': 8, 'mlp_ratio': 4, 'cond_lq': True, 'lq_size': 64}}, 'diffusion': {'target': 'models.script_util.create_gaussian_diffusion', 'params': {'sf': 4, 'schedule_name': 'exponential', 'schedule_kwargs': {'power': 0.3}, 'etas_end': 0.99, 'steps': 15, 'min_noise_level': 0.04, 'kappa': 2.0, 'weighted_mse': False, 'predict_type': 'xstart', 'timestep_respacing': None, 'scale_factor': 1.0, 'normalize_input': True, 'latent_flag': True}}, 'autoencoder': {'target': 'ldm.models.autoencoder.VQModelTorch', 'ckpt_path': 'weights/autoencoder_vq_f4.pth', 'use_fp16': True, 'tune_decoder': False, 'params': {'lora_tune_decoder': False, 'embed_dim': 3, 'n_embed': 8192, 'ddconfig': {'double_z': False, 'z_channels': 3, 'resolution': 256, 'in_channels': 3, 'out_ch': 3, 'ch': 128, 'ch_mult': [1, 2, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0, 'padding_mode': 'zeros'}}}, 'degradation': {'sf': 4, 'resize_prob': [0.2, 0.7, 0.1], 'resize_range': [0.15, 1.5], 'gaussian_noise_prob': 0.5, 'noise_range': [1, 30], 'poisson_scale_range': [0.05, 3.0], 'gray_noise_prob': 0.4, 'jpeg_range': [30, 95], 'second_order_prob': 0.5, 'second_blur_prob': 0.8, 'resize_prob2': [0.3, 0.4, 0.3], 'resize_range2': [0.3, 1.2], 'gaussian_noise_prob2': 0.5, 'noise_range2': [1, 25], 'poisson_scale_range2': [0.05, 2.5], 'gray_noise_prob2': 0.4, 'jpeg_range2': [30, 95], 'gt_size': 256, 'resize_back': False, 'use_sharp': False}, 'data': {'train': {'type': 'PairedImageDataset', 'params': {'opt': {'dataroot_gt': '../ChestCT/HR', 'dataroot_lq': '../ChestCT/LR', 'dataroot_mask': '../ChestCT/mask', 'meta_info_file': 'data/meta_info/meta_info_ChestCT_val_2715_part_60.txt', 'io_backend': {'type': 'disk'}, 'gt_size': 256, 'use_hflip': True, 'use_rot': True, 'scale': 4, 'phase': 'train'}}}, 'val': {'type': 'PairedImageDataset', 'params': {'opt': {'dataroot_gt': '../ChestCT/HR', 'dataroot_lq': '../ChestCT/LR', 'dataroot_mask': '../ChestCT/mask', 'meta_info_file': 'data/meta_info/meta_info_ChestCT_val_2715_part_60.txt', 'io_backend': {'type': 'disk'}, 'scale': 4, 'phase': 'val'}}}}, 'train': {'lr': 5e-05, 'lr_min': 2e-05, 'lr_schedule': None, 'warmup_iterations': 5000, 'batch': [8, 1], 'microbatch': 8, 'num_workers': 4, 'prefetch_factor': 2, 'weight_decay': 0, 'ema_rate': 0.999, 'iterations': 300000, 'save_freq': 10000, 'log_freq': [200, 2000, 1], 'local_logging': True, 'tf_logging': False, 'use_ema_val': True, 'val_freq': 200, 'val_y_channel': True, 'val_resolution': 64, 'val_padding_mode': 'reflect', 'use_amp': True, 'seed': 123456, 'global_seeding': False, 'compile': {'flag': False, 'mode': 'reduce-overhead'}, 'scale': 4}, 'division': {'division_size': 64, 'overlap_size': 4}, 'logger': {'wandb': {'project': 'experiment5', 'name': 'ronbunnomama', 'id': None}}, 'save_dir': 'results', 'resume': '', 'cfg_path': 'configs/realsr_swinunet_realesrgan256.yaml', '_wandb': {}}
2025-10-19 08:41:02,107 INFO    MainThread:97336 [wandb_init.py:init():893] starting backend
2025-10-19 08:41:02,107 INFO    MainThread:97336 [wandb_init.py:init():897] sending inform_init request
2025-10-19 08:41:02,123 INFO    MainThread:97336 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-10-19 08:41:02,123 INFO    MainThread:97336 [wandb_init.py:init():907] backend started and connected
2025-10-19 08:41:02,128 INFO    MainThread:97336 [wandb_init.py:init():1005] updated telemetry
2025-10-19 08:41:02,235 INFO    MainThread:97336 [wandb_init.py:init():1029] communicating run to backend with 90.0 second timeout
2025-10-19 08:41:02,914 INFO    MainThread:97336 [wandb_init.py:init():1104] starting run threads in backend
2025-10-19 08:41:03,023 INFO    MainThread:97336 [wandb_run.py:_console_start():2573] atexit reg
2025-10-19 08:41:03,023 INFO    MainThread:97336 [wandb_run.py:_redirect():2421] redirect: wrap_raw
2025-10-19 08:41:03,024 INFO    MainThread:97336 [wandb_run.py:_redirect():2490] Wrapping output streams.
2025-10-19 08:41:03,024 INFO    MainThread:97336 [wandb_run.py:_redirect():2513] Redirects installed.
2025-10-19 08:41:03,030 INFO    MainThread:97336 [wandb_init.py:init():1150] run started, returning control to user process
2025-10-19 08:48:44,199 INFO    MsgRouterThr:97336 [mailbox.py:close():129] [no run ID] Closing mailbox, abandoning 1 handles.
